---
title: "Weak Forms and Problem Setup — Twisting of a Neo-Hookean Block"
format:
  html:
    theme:
      light: flatly
      dark: darkly
    page-layout: full
    css: styles.css
    toc: false
---

# 1. Governing equations

## 1.1 Geometry and boundary

The reference configuration is

$$
\Omega = (0, L_x) \times (0, L_y) \times (0, L_z) \subset \mathbb{R}^3, \quad L_x = 10,\ L_y = L_z = 1.
$$

Partition the boundary:

$$
\Gamma_L = \{ x = 0 \}, \quad \Gamma_R = \{ x = L_x \}, \quad \Gamma_N = \partial \Omega \setminus (\Gamma_L \cup \Gamma_R).
$$

## 1.2 Material model

Let \( u : \Omega \to \mathbb{R}^3 \) be the displacement. Define:

$$
F = I + \nabla u, \quad J = \det F, \quad F^{-T} = (F^{-1})^T.
$$

For Lamé parameters \( \mu, \lambda > 0 \), the first Piola–Kirchhoff stress is:

$$
P(F) = \mu F + (\lambda \ln J - \mu) F^{-T}.
$$

## 1.3 Strong form

Seek \( u \) such that:

$$
-\nabla \cdot P(u) = 0 \quad \text{in } \Omega, \\
u = 0 \quad \text{on } \Gamma_L, \\
u = g \quad \text{on } \Gamma_R, \\
P(u)n = 0 \quad \text{on } \Gamma_N,
$$

with prescribed displacement on \( \Gamma_R \):

$$
g(x, y, z) =
\begin{pmatrix}
-0.1 \\
y(\cos \pi - 1) - z \sin \pi \\
y \sin \pi + z(\cos \pi - 1)
\end{pmatrix}.
$$

# 2. Weak form and derivations

Multiply the strong form by a test function \( v \in V \) and integrate over \( \Omega \):

$$
0 = \int_\Omega (-\nabla \cdot P) \cdot v \, dx = -\int_{\partial \Omega} (Pn) \cdot v \, ds + \int_\Omega P : \nabla v \, dx.
$$

On \( \Gamma_N \), we have \( Pn = 0 \), and on \( \Gamma_L \cup \Gamma_R \), the variation \( v = 0 \), so the boundary integral vanishes.

Hence the weak form:

$$
\int_\Omega \left[ \mu\, \text{tr}(F^T \nabla v) + (\lambda \ln J - \mu)\, \text{tr}(F^{-T} \nabla v) \right] dx = 0 \quad \forall v \in V.
$$

### Derivation of the weak form

Starting from:

$$
0 = \int_\Omega (-\nabla \cdot P) \cdot v \, dx,
$$

apply Gauss’ theorem and note vanishing boundary terms as above.

Rewriting \( P : \nabla v = \text{tr}(P^T \nabla v) \) and substituting the expression for \( P(F) \) yields the boxed form.

## 2.1 Jacobian (Fréchet derivative)

Define the residual functional:

$$
R(u)[v] = \int_\Omega P(F(u)) : \nabla v \, dx.
$$

Its Fréchet derivative in direction \( \delta u \) is:

$$
DR(u)[\delta u, v] =
\left. \frac{d}{d\varepsilon} R(u + \varepsilon \delta u)[v] \right|_{\varepsilon = 0}
= \int_\Omega \delta P : \nabla v \, dx.
$$

We compute variations:

- \( \delta F = \nabla \delta u \)
- \( \delta J = J \, \text{tr}(F^{-1} \nabla \delta u) \)
- \( \delta \ln J = \text{tr}(F^{-1} \nabla \delta u) \)
- \( \delta(F^{-T}) = -F^{-T} (\nabla \delta u) F^{-T} \)

Thus:

$$
\delta P =
\mu \nabla \delta u
- (\lambda \ln J - \mu) F^{-T} (\nabla \delta u) F^{-T}
+ \lambda \, \text{tr}(F^{-1} \nabla \delta u) F^{-T}.
$$

Substitution gives the Jacobian bilinear form:

$$
DR(u)[\delta u, v] =
\int_\Omega \left[
\mu\, \text{tr}((\nabla \delta u)^T \nabla v)
- (\lambda \ln J - \mu)\, \text{tr}((\nabla \delta u F^{-1})^T (\nabla v F^{-1}))
+ \lambda\, \text{tr}(F^{-1} \nabla \delta u) \, \text{tr}(F^{-1} \nabla v)
\right] dx.
$$
